CREATE DATABASE ecommerce;

-- Conectarse a la base de datos creada
\c ecommerce;

--
-- PostgreSQL database dump
--

-- Dumped from database version 17.2
-- Dumped by pg_dump version 17.2

-- Started on 2025-02-08 12:13:16

SET statement_timeout = 0;
SET lock_timeout = 0;
SET idle_in_transaction_session_timeout = 0;
SET transaction_timeout = 0;
SET client_encoding = 'UTF8';
SET standard_conforming_strings = on;
SELECT pg_catalog.set_config('search_path', '', false);
SET check_function_bodies = false;
SET xmloption = content;
SET client_min_messages = warning;
SET row_security = off;

SET default_tablespace = '';

SET default_table_access_method = heap;

--
-- TOC entry 220 (class 1259 OID 16401)
-- Name: categories; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.categories (
    id integer NOT NULL,
    date_created timestamp(6) without time zone,
    date_updated timestamp(6) without time zone,
    name character varying(255)
);


ALTER TABLE public.categories OWNER TO postgres;

--
-- TOC entry 219 (class 1259 OID 16400)
-- Name: categories_id_seq; Type: SEQUENCE; Schema: public; Owner: postgres
--

ALTER TABLE public.categories ALTER COLUMN id ADD GENERATED BY DEFAULT AS IDENTITY (
    SEQUENCE NAME public.categories_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1
);


--
-- TOC entry 224 (class 1259 OID 16425)
-- Name: order_products; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.order_products (
    id integer NOT NULL,
    product_id integer,
    price numeric(38,2),
    quantity numeric(38,2),
    order_entity_id integer
);


ALTER TABLE public.order_products OWNER TO postgres;

--
-- TOC entry 223 (class 1259 OID 16424)
-- Name: order_products_id_seq; Type: SEQUENCE; Schema: public; Owner: postgres
--

ALTER TABLE public.order_products ALTER COLUMN id ADD GENERATED BY DEFAULT AS IDENTITY (
    SEQUENCE NAME public.order_products_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1
);


--
-- TOC entry 226 (class 1259 OID 16431)
-- Name: orders; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.orders (
    id integer NOT NULL,
    date_created timestamp(6) without time zone,
    order_state character varying(255),
    user_entity_id integer,
    CONSTRAINT orders_order_state_check CHECK (((order_state)::text = ANY ((ARRAY['CANCELLED'::character varying, 'CONFIRMED'::character varying])::text[])))
);


ALTER TABLE public.orders OWNER TO postgres;

--
-- TOC entry 225 (class 1259 OID 16430)
-- Name: orders_id_seq; Type: SEQUENCE; Schema: public; Owner: postgres
--

ALTER TABLE public.orders ALTER COLUMN id ADD GENERATED BY DEFAULT AS IDENTITY (
    SEQUENCE NAME public.orders_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1
);


--
-- TOC entry 222 (class 1259 OID 16407)
-- Name: products; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.products (
    id integer NOT NULL,
    code character varying(255),
    date_created timestamp(6) without time zone,
    description character varying(255),
    name character varying(255),
    price numeric(38,2),
    url_image character varying(255),
    category_entity_id integer,
    user_entity_id integer,
    date_updated timestamp(6) without time zone
);


ALTER TABLE public.products OWNER TO postgres;

--
-- TOC entry 221 (class 1259 OID 16406)
-- Name: products_id_seq; Type: SEQUENCE; Schema: public; Owner: postgres
--

ALTER TABLE public.products ALTER COLUMN id ADD GENERATED BY DEFAULT AS IDENTITY (
    SEQUENCE NAME public.products_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1
);


--
-- TOC entry 218 (class 1259 OID 16390)
-- Name: users; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.users (
    id integer NOT NULL,
    address character varying(255),
    cell_phone character varying(255),
    date_created timestamp(6) without time zone,
    date_updated timestamp(6) without time zone,
    email character varying(255),
    first_name character varying(255),
    last_name character varying(255),
    password character varying(255),
    user_type character varying(255),
    username character varying(255),
    CONSTRAINT users_user_type_check CHECK (((user_type)::text = ANY ((ARRAY['ADMIN'::character varying, 'USER'::character varying])::text[])))
);


ALTER TABLE public.users OWNER TO postgres;

--
-- TOC entry 217 (class 1259 OID 16389)
-- Name: users_id_seq; Type: SEQUENCE; Schema: public; Owner: postgres
--

ALTER TABLE public.users ALTER COLUMN id ADD GENERATED BY DEFAULT AS IDENTITY (
    SEQUENCE NAME public.users_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1
);


--
-- TOC entry 4881 (class 0 OID 16401)
-- Dependencies: 220
-- Data for Name: categories; Type: TABLE DATA; Schema: public; Owner: postgres
--

COPY public.categories (id, date_created, date_updated, name) FROM stdin;
2	2025-01-22 06:35:41.50335	2025-01-22 06:35:41.50335	Drinks
3	2025-01-22 08:12:08.3663	2025-01-22 08:12:08.3663	TV
4	2025-01-22 20:09:20.209484	2025-01-22 20:09:20.209484	PC
5	2025-01-22 20:09:20.209484	2025-01-28 14:24:09.210376	Accessories
\.


--
-- TOC entry 4885 (class 0 OID 16425)
-- Dependencies: 224
-- Data for Name: order_products; Type: TABLE DATA; Schema: public; Owner: postgres
--

COPY public.order_products (id, product_id, price, quantity, order_entity_id) FROM stdin;
94	3	800.00	1.00	39
95	3	800.00	2.00	40
96	4	1030.00	1.00	41
97	1	1000.00	1.00	42
\.


--
-- TOC entry 4887 (class 0 OID 16431)
-- Dependencies: 226
-- Data for Name: orders; Type: TABLE DATA; Schema: public; Owner: postgres
--

COPY public.orders (id, date_created, order_state, user_entity_id) FROM stdin;
39	2025-02-07 06:39:53.50652	CANCELLED	1
40	2025-02-08 12:03:11.684314	CANCELLED	1
41	2025-02-08 12:05:28.550555	CANCELLED	1
42	2025-02-08 12:05:49.49252	CANCELLED	1
\.


--
-- TOC entry 4883 (class 0 OID 16407)
-- Dependencies: 222
-- Data for Name: products; Type: TABLE DATA; Schema: public; Owner: postgres
--

COPY public.products (id, code, date_created, description, name, price, url_image, category_entity_id, user_entity_id, date_updated) FROM stdin;
1	PROD_2025-01-27_bacb7	2025-01-27 14:41:04.333659	TV	Amazon Fire TV	1000.00	http://localhost:8085/images/Televisión inteligente Amazon Fire TV.jpg	3	1	2025-01-27 14:41:04.333659
2	PROD_2025-01-27_5c2d9	2025-01-27 14:41:04.333659	printer	printer	100.00	http://localhost:8085/images/impresora.jpg	5	1	2025-01-27 14:42:36.937735
3	PROD_2025-01-28_3dae1	2025-01-27 14:41:04.333659	PC	Apple MacBook Pro 2022	800.00	http://localhost:8085/images/Apple MacBook Pro 2022.jpg	4	1	2025-01-28 14:54:51.887586
4	PROD_2025-01-28_3dae2	2025-01-27 14:41:04.333659	PC	HP Pavilion 15	1030.00	http://localhost:8085/images/HP Pavilion 15.jpg	4	1	2025-01-28 14:54:51.887586
5	PROD_2025-01-28_3dae3	2025-01-27 14:41:04.333659	PC	Laptop Lenovo Ideapad 3 2022	1500.00	http://localhost:8085/images/Laptop Lenovo Ideapad 3 2022.jpg	4	1	2025-01-28 14:54:51.887586
6	PROD_2025-01-28_3dae4	2025-01-27 14:41:04.333659	PC	E-YOOSO	20.00	http://localhost:8085/images/E-YOOSO.jpg	5	1	2025-01-28 14:54:51.887586
7	PROD_2025-01-28_3dae5	2025-01-27 14:41:04.333659	PC	Logitech M510	20.00	http://localhost:8085/images/Logitech M510.jpg	5	1	2025-01-28 14:54:51.887586
8	PROD_2025-02-07_0b08c	2025-02-07 06:28:33.533723	asasa	Drink test	10.00	http://localhost:8085/images/default.jpg	2	7	2025-02-07 06:28:33.533723
\.


--
-- TOC entry 4879 (class 0 OID 16390)
-- Dependencies: 218
-- Data for Name: users; Type: TABLE DATA; Schema: public; Owner: postgres
--

COPY public.users (id, address, cell_phone, date_created, date_updated, email, first_name, last_name, password, user_type, username) FROM stdin;
7	Invented Street 3, Gijón	654123200	2025-02-03 20:08:56.420977	2025-02-03 20:08:56.420977	pgs2@hotmail.com	Pablo	Simavilla	$2a$10$FGMYl61ph0JS0n73KpvT1.2UmbfBEwwaLAdxDXfJ/ZCBq7yRLQwF.	ADMIN	pgs2
1	Invented Street 3, Gijón	654123200	2025-01-21 22:25:35.683531	2025-01-21 22:25:35.683531	pgs@hotmail.com	Pablo	Simavilla	$2a$10$FGMYl61ph0JS0n73KpvT1.2UmbfBEwwaLAdxDXfJ/ZCBq7yRLQwF.	USER	pgs
\.


--
-- TOC entry 4893 (class 0 OID 0)
-- Dependencies: 219
-- Name: categories_id_seq; Type: SEQUENCE SET; Schema: public; Owner: postgres
--

SELECT pg_catalog.setval('public.categories_id_seq', 5, true);


--
-- TOC entry 4894 (class 0 OID 0)
-- Dependencies: 223
-- Name: order_products_id_seq; Type: SEQUENCE SET; Schema: public; Owner: postgres
--

SELECT pg_catalog.setval('public.order_products_id_seq', 97, true);


--
-- TOC entry 4895 (class 0 OID 0)
-- Dependencies: 225
-- Name: orders_id_seq; Type: SEQUENCE SET; Schema: public; Owner: postgres
--

SELECT pg_catalog.setval('public.orders_id_seq', 42, true);


--
-- TOC entry 4896 (class 0 OID 0)
-- Dependencies: 221
-- Name: products_id_seq; Type: SEQUENCE SET; Schema: public; Owner: postgres
--

SELECT pg_catalog.setval('public.products_id_seq', 8, true);


--
-- TOC entry 4897 (class 0 OID 0)
-- Dependencies: 217
-- Name: users_id_seq; Type: SEQUENCE SET; Schema: public; Owner: postgres
--

SELECT pg_catalog.setval('public.users_id_seq', 11, true);


--
-- TOC entry 4722 (class 2606 OID 16405)
-- Name: categories categories_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.categories
    ADD CONSTRAINT categories_pkey PRIMARY KEY (id);


--
-- TOC entry 4726 (class 2606 OID 16429)
-- Name: order_products order_products_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.order_products
    ADD CONSTRAINT order_products_pkey PRIMARY KEY (id);


--
-- TOC entry 4728 (class 2606 OID 16436)
-- Name: orders orders_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.orders
    ADD CONSTRAINT orders_pkey PRIMARY KEY (id);


--
-- TOC entry 4724 (class 2606 OID 16413)
-- Name: products products_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.products
    ADD CONSTRAINT products_pkey PRIMARY KEY (id);


--
-- TOC entry 4718 (class 2606 OID 16399)
-- Name: users uk6dotkott2kjsp8vw4d0m25fb7; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.users
    ADD CONSTRAINT uk6dotkott2kjsp8vw4d0m25fb7 UNIQUE (email);


--
-- TOC entry 4720 (class 2606 OID 16397)
-- Name: users users_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.users
    ADD CONSTRAINT users_pkey PRIMARY KEY (id);


--
-- TOC entry 4729 (class 2606 OID 16419)
-- Name: products fk8so90o4249ddoho1u5jo40a1s; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.products
    ADD CONSTRAINT fk8so90o4249ddoho1u5jo40a1s FOREIGN KEY (user_entity_id) REFERENCES public.users(id);


--
-- TOC entry 4730 (class 2606 OID 16414)
-- Name: products fk951e06xja0u6kgpeujclwflr0; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.products
    ADD CONSTRAINT fk951e06xja0u6kgpeujclwflr0 FOREIGN KEY (category_entity_id) REFERENCES public.categories(id);


--
-- TOC entry 4732 (class 2606 OID 16442)
-- Name: orders fkbf3y2qx6ygklmr5xvdsvokteo; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.orders
    ADD CONSTRAINT fkbf3y2qx6ygklmr5xvdsvokteo FOREIGN KEY (user_entity_id) REFERENCES public.users(id);


--
-- TOC entry 4731 (class 2606 OID 16437)
-- Name: order_products fkf7y1i8ilaq7hg00i39p2axl0o; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.order_products
    ADD CONSTRAINT fkf7y1i8ilaq7hg00i39p2axl0o FOREIGN KEY (order_entity_id) REFERENCES public.orders(id);


-- Completed on 2025-02-08 12:13:16

--
-- PostgreSQL database dump complete
--

